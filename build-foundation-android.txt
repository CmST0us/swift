// need to fix ndk25
// https://github.com/apple/swift/issues/64321

export NDK_PATH="/home/eki/Project/ndk/android-ndk-r25c"
export icu_libs=/home/eki/libiconv-libicu-android/arm64-v8a
export foundation_dependencies=/home/eki/foundation-dependencies/arm64
cmake -G Ninja -DCMAKE_TOOLCHAIN_FILE=/home/eki/Project/ndk/android-ndk-r25c/build/cmake/android.toolchain.cmake \
    -DCMAKE_INSTALL_PREFIX=/home/eki/Project/swift-project/build/buildbot_linux/foundation-android-aarch64-install \
    -DCMAKE_BUILD_TYPE=Release \
    -DBUILD_SHARED_LIBS=ON \
    -Ddispatch_DIR=/home/eki/Project/swift-project/build/buildbot_linux/libdispatch-android-aarch64/cmake/modules \
    \
    -DICU_INCLUDE_DIR=$icu_libs/include \
    -DICU_UC_LIBRARY=$icu_libs/libicuucswift.so \
    -DICU_UC_LIBRARY_RELEASE=$icu_libs/libicuucswift.so \
    -DICU_I18N_LIBRARY=$icu_libs/libicui18nswift.so \
    -DICU_I18N_LIBRARY_RELEASE=$icu_libs/libicui18nswift.so \
    \
    -DCURL_LIBRARY=$foundation_dependencies/lib/libcurl.so \
    -DCURL_INCLUDE_DIR=$foundation_dependencies/include \
    \
    -DLIBXML2_LIBRARY=$foundation_dependencies/lib/libxml2.so \
    -DLIBXML2_INCLUDE_DIR=$foundation_dependencies/include/libxml2 \
    \
    -DCMAKE_HAVE_LIBC_PTHREAD=YES \
    -DANDROID_ABI=arm64-v8a \
    -DANDROID_PLATFORM=android-28 \
    -DANDROID_NDK=/home/eki/Project/ndk/android-ndk-r25c \
    -DCMAKE_Swift_COMPILER="/home/eki/Project/swift-project/toolchain/swift-android-ndk-aarch64-install/usr/bin/swiftc" \
    -DCMAKE_Swift_FLAGS="-target aarch64-unknown-linux-android28 -tools-directory ${NDK_PATH}/toolchains/llvm/prebuilt/linux-x86_64/bin/ -sdk ${NDK_PATH}/toolchains/llvm/prebuilt/linux-x86_64/sysroot -resource-dir /home/eki/Project/swift-project/build/buildbot_linux/swift-linux-x86_64/lib/swift" \
    ../../../swift-corelibs-foundation
